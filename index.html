<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Another Scratch Lab â€“ Performance Engine</title>

<style>
body{background:#000;color:#fff;font-family:Arial;padding:20px}
h1{color:#ff1744;text-align:center}
select,input,button{
width:100%;padding:12px;margin-top:10px;
border-radius:8px;border:none;font-size:16px}
button{background:#ff1744;color:#fff;font-weight:bold}
.result{margin-top:20px;padding:15px;background:#111;border-radius:10px}
.combo{background:#1a1a1a;padding:10px;margin-top:10px;border-radius:8px;font-size:18px}
iframe{width:100%;height:220px;margin-top:10px;border-radius:10px}
canvas{background:#111;border-radius:10px;margin-top:10px}
.section-title{color:#ff1744;margin-top:20px}
</style>
</head>
<body>

<h1>ANOTHER SCRATCH LAB â€“ PERFORMANCE ENGINE</h1>

<select id="mode">
<option value="club">ğŸ§ Club Mode</option>
<option value="battle">ğŸ¥Š Battle Mode</option>
</select>

<select id="level">
<option value="low">ë‚œì´ë„: í•˜</option>
<option value="mid">ë‚œì´ë„: ì¤‘</option>
<option value="high">ë‚œì´ë„: ìƒ</option>
</select>

<input type="number" id="bpmInput" placeholder="í˜„ì¬ íŠ¸ë™ BPM ì…ë ¥">

<button onclick="generate()">ì½¤ë³´ ìƒì„±</button>

<div id="result" class="result"></div>

<script>

// BPM êµ¬ê°„
function bpmRange(bpm){
if(bpm<90) return "A";
if(bpm<100) return "B";
if(bpm<110) return "C";
if(bpm<120) return "D";
if(bpm<135) return "E";
return "F";
}

// ê¸°ìˆ  í’€
const pool = {
A:{low:["Baby","Chirp"],
   mid:["Baby","Chirp","Tear"],
   high:["Tear","1Click","Orbit"]},
B:{low:["Baby","Chirp","Stab"],
   mid:["2Click","Tear","Transformer"],
   high:["Orbit","Crab","2Click"]},
C:{low:["Chirp","Transformer"],
   mid:["2Click","Orbit","Crab"],
   high:["3Click","Twiddle","Orbit"]},
D:{low:["Transformer","Chirp"],
   mid:["Orbit","Crab","2Click"],
   high:["3Click","Twiddle","Boomerang"]},
E:{low:["Baby","Transformer"],
   mid:["Orbit","Crab"],
   high:["Fast Orbit","Crab Burst"]},
F:{low:["Transformer"],
   mid:["Fast Orbit","Crab"],
   high:["Fast Orbit","Crab Burst","Twiddle"]}
};

// í…ì…˜ ì ìˆ˜
const tensionMap={
"Baby":1,"Chirp":2,"Tear":3,"Transformer":3,
"1Click":4,"2Click":5,"Orbit":6,"Crab":7,
"3Click":8,"Twiddle":9,"Boomerang":7,
"Fast Orbit":8,"Crab Burst":9,"Stab":2
};

// ì—°ê²° ì¶”ì²œ
const connectionMap={
"Baby":["Chirp","Tear"],
"Chirp":["2Click","Orbit"],
"Tear":["Orbit","Transformer"],
"1Click":["2Click","Orbit"],
"2Click":["Orbit","Crab"],
"Orbit":["Crab","Twiddle"],
"Crab":["3Click","Boomerang"],
"3Click":["Twiddle","Crab Burst"],
"Twiddle":["Crab Burst"],
"Fast Orbit":["Crab Burst"],
"Transformer":["Orbit"],
"Boomerang":["Twiddle"]
};

function rand(arr){return arr[Math.floor(Math.random()*arr.length)]}

function buildCombo(mode,range,level){
let arr=pool[range][level];
let combo=[];
let count=mode==="club"?3:4;
for(let i=0;i<count;i++){
combo.push(rand(arr));
}
if(mode==="club") combo.push("Stab");
return combo;
}

function generate(){
const bpm=parseInt(document.getElementById("bpmInput").value);
if(!bpm){alert("BPM ì…ë ¥");return;}
const mode=document.getElementById("mode").value;
const level=document.getElementById("level").value;
const range=bpmRange(bpm);
let combo=buildCombo(mode,range,level);
render(combo,mode);
}

function render(combo,mode){

let html=`<h2>${mode==="club"?"ğŸ§ CLUB PERFORMANCE":"ğŸ¥Š BATTLE PERFORMANCE"}</h2>`;
html+=`<div class="combo">${combo.join(" â†’ ")}</div>`;

// ì—°ê²° ì¶”ì²œ
let last=combo[combo.length-1];
let suggestions=connectionMap[last]||[];
if(suggestions.length>0){
html+=`<div class="section-title">ğŸ”¥ ë‹¤ìŒ ì—°ê²° ì¶”ì²œ</div>`;
html+=`<div>${suggestions.join(" / ")}</div>`;
}

// í…ì…˜ ê·¸ë˜í”„
html+=`<div class="section-title">ğŸ“ˆ Tension Flow</div>
<canvas id="tensionChart" width="320" height="150"></canvas>`;

// ì˜ìƒ (ê²€ìƒ‰ embed ë°©ì‹)
combo.forEach(move=>{
html+=`
<div class="section-title">ğŸ¥ ${move} Tutorial</div>
<iframe 
src="https://www.youtube.com/embed?listType=search&list=${move}+scratch+tutorial"
allowfullscreen>
</iframe>
`;
});

document.getElementById("result").innerHTML=html;

drawGraph(combo);
}

function drawGraph(combo){
let canvas=document.getElementById("tensionChart");
let ctx=canvas.getContext("2d");
ctx.clearRect(0,0,canvas.width,canvas.height);
let max=10;
let stepX=canvas.width/(combo.length+1);
ctx.beginPath();
combo.forEach((move,i)=>{
let t=tensionMap[move]||1;
let x=stepX*(i+1);
let y=canvas.height-(t/max)*canvas.height;
if(i===0){ctx.moveTo(x,y);}else{ctx.lineTo(x,y);}
});
ctx.strokeStyle="#ff1744";
ctx.lineWidth=2;
ctx.stroke();
}

</script>
</body>
</html>